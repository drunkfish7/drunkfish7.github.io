<!DOCTYPE html>
<html lang="zh-CN">







<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<link rel="preconnect" href="//www.googletagmanager.com">
	<link rel="preconnect" href="//zz.bdstatic.com">
	<link rel="preconnect" href="//sp0.baidu.com">
	<link rel="preconnect" href="//www.google-analytics.com">
	<link rel="preconnect" href="//cdn1.lncld.net">
	<link rel="preconnect" href="//unpkg.com">
	<link rel="preconnect" href="//app-router.leancloud.cn">
	<link rel="preconnect" href="//9qpuwspm.api.lncld.net">
	<link rel="preconnect" href="//gravatar.loli.net">

	<title>大国特色奇异技巧系列之二：Telegram 收发微信消息 | 庄菲什</title>

	<meta name="HandheldFriendly" content="True" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
	<meta name="generator" content="hexo">
	<meta name="author" content="drunkfish">
	<meta name="description" content="">

	

	

	

	

	

	<meta property="og:site_name" content="庄菲什">
	<meta property="og:type" content="article">
	<meta property="og:title" content="大国特色奇异技巧系列之二：Telegram 收发微信消息 | 庄菲什">
	<meta property="og:description" content="">
	<meta property="og:url" content="http://yoursite.com/ehforwarderbot/">

	
	<meta property="article:published_time" content="2020-06-26T00:06:00+08:00"/> 
	<meta property="article:author" content="drunkfish">
	<meta property="article:published_first" content="庄菲什, /ehforwarderbot/" />
	

	
	
	
<link rel="stylesheet" href="/css/allinonecss.min.css">


	
	
	
<link rel="alternate" href="/atom.xml" title="庄菲什" type="application/atom+xml">
</head>
<body class="post-template">
	<div class="site-wrapper">
		




<header class="site-header post-site-header outer">
    <div class="inner">
        
<nav class="site-nav"> 
    <div class="site-nav-left">
        <ul class="nav">
            <li>
                
                <a href="/" title="Home">HOME</a>
                
            </li>
            
        </ul> 
    </div>
     
    <div class="site-nav-right">
         
        
<div class="social-links" >
    
    
    
    
    
    
    
</div>
    </div>
</nav>
    </div>
</header>


<div id="site-main" class="site-main outer" role="main">
    <div class="inner">
        <header class="post-full-header">
            <div class="post-full-meta">
                <time  class="post-full-meta-date" datetime="2020-06-26T00:00:00.000Z">
                    2020-06-26
                </time>
                
                <span class="date-divider">/</span>
                
                
            </div>
            <h1 class="post-full-title">大国特色奇异技巧系列之二：Telegram 收发微信消息</h1>
        </header>
        <div class="post-full no-image">
            
            <div class="post-full-content">
                <article id="photoswipe" class="markdown-body">
                    <p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic2@master/uPic/ehforwarderbot_cover.png" alt="ehforwarderbot_cover"></p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic2@master/uPic/ehforwarderbot_ui.png" alt="ehforwarderbot_ui"></p>
<p>不鳥萬如一老师曾讨论过<a href="https://blog.yitianshijie.net/2018/02/27/2nd-anniversary-of-ditching-wechat/" target="_blank" rel="noopener">关于微信</a>，小弟很赞成其中的观点。微信可以成功，和防火长城关系密切。<a href="https://telegram.org/" target="_blank" rel="noopener">Telegram</a> 是一款在功能及体验上远超微信的即时聊天工具，关于 Telegram 的传奇故事可以参见<a href="https://www.tmtpost.com/1443098.html" target="_blank" rel="noopener">这篇</a>。</p>
<p><a href="https://github.com/blueset/ehForwarderBot" target="_blank" rel="noopener">EH Forwarder Bot</a> 是一位大大开发的一个消息隧道聊天机器人框架，可将一个平台的消息转到另一个平台，其中包括将微信消息转发至 Telegram。</p>
<p>这个小工具可以将 Web 端的微信消息转发至 Telegram，这样做有几个好处：1、使用更现代的 Telegram 聊天界面收发微信消息；2、聊天记录在 Telegram 云备份一份；3、得益于 Telegram 优秀的跨平台特性，可以更方便多平台使用微信；4、 Telegram 的某些功能，如超多的贴图、定时发信息等也可以使用。</p>
<p>使用 EH Forwarder Bot 微信消息转至 Telegram 需要准备：1、可以连外网的 VPS 或连外网的群晖（推荐）；2、两个 Telegram 账号；3、确保微信可以正常登录 Web 端。</p>
<h2 id="配置-Telegram-机器人"><a href="#配置-Telegram-机器人" class="headerlink" title="配置 Telegram 机器人"></a>配置 Telegram 机器人</h2><h3 id="创建-Telegram-机器人"><a href="#创建-Telegram-机器人" class="headerlink" title="创建 Telegram 机器人"></a>创建 Telegram 机器人</h3><p>首先创建一个新的 Telegram 机器人，打开 Telegram 应用，与 <a href="https://t.me/BotFather" target="_blank" rel="noopener">@BotFather</a> 开始对话，</p>
<p>发送 <code>/start</code> ，可以看到各种指令及简要说明，</p>
<p>发送 <code>/newbot</code> 创建一个新机器人，之后会询问机器人的名字及机器人的用户名，根据提示输入即可。</p>
<p>之后会返回机器人的 token，记下备用。</p>
<h3 id="配置-Telegram-机器人-1"><a href="#配置-Telegram-机器人-1" class="headerlink" title="配置 Telegram 机器人"></a>配置 Telegram 机器人</h3><p>接下来配置刚刚建立的 Telegram 机器人，</p>
<p>发送 <code>/setprivacy</code> 至 @BotFather，选择刚刚建立的机器人，设置为 <code>Disable</code>，</p>
<p>发送 <code>/setjoingroups</code> 至 @BotFather，选择刚刚建立的机器人，设置为 <code>Enable</code>，</p>
<p>发送 <code>/setcommands</code> 至 @BotFather，选择刚刚建立的机器人，回复以下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">help - 显示命令清单</span><br><span class="line">link - 连接对话到 TG 群组</span><br><span class="line">unlink_all - 解除群组中所有对话的连接</span><br><span class="line">info - 显示当前对话的详细信息</span><br><span class="line">chat - 创建对话</span><br><span class="line">recog - 回复语音消息以进行识别</span><br><span class="line">extra - 获取更多功能</span><br><span class="line">update_info - 更新组群名字及头像</span><br></pre></td></tr></table></figure>

<h3 id="获取-Telegram-ID"><a href="#获取-Telegram-ID" class="headerlink" title="获取 Telegram ID"></a>获取 Telegram ID</h3><p>之后获取自己的 Telegram ID，与 <a href="https://t.me/get_id_bot" target="_blank" rel="noopener">@get_id_bot</a> 对话，发送 <code>/start</code>，获得的一串数字即为自己的 ID，记下这串数字备用。</p>
<h2 id="配置-Docker"><a href="#配置-Docker" class="headerlink" title="配置 Docker"></a>配置 Docker</h2><p>首先确保 VPS 或群晖可以连外网，Telegram 目前需要连外网才能用。另外，有些 VPS 可能触发微信的异地登录，导致登录 Web 端微信失败（小弟有尝试在谷歌云上搭建，最后导致禁止 Web 端登录微信），相对比较安全且稳定的是在连外网的群晖上搭建。</p>
<p>小弟使用的是<a href="https://hub.docker.com/r/jemyzhang/ehforwarderbot" target="_blank" rel="noopener">这个大大的 Docker</a>。首先新建存放这个 Docker 的文件夹，文件夹依照下面的层级结构建立好子文件目录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">📂profiles</span><br><span class="line">└── 📂default</span><br><span class="line">    ├── 📂blueset.telegram</span><br><span class="line">    │   └── config.yaml</span><br><span class="line">    ├── 📂blueset.wechat</span><br><span class="line">    └── config.yaml</span><br></pre></td></tr></table></figure>

<p>其中，<code>profiles/default/config.yaml</code> 这个文件输入以下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master_channel: blueset.telegram</span><br><span class="line">slave_channels:</span><br><span class="line">  - blueset.wechat</span><br></pre></td></tr></table></figure>

<p><code>profiles/default/blueset.telegram/config.yaml</code> 这个文件中输入机器人的 token 和 Telegram ID，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">token: &quot;123456789:ABCD_1-1A2BASDFA_ASFASDFASDFASDFASF&quot;</span><br><span class="line">admins:</span><br><span class="line">- 1234567</span><br></pre></td></tr></table></figure>

<p>打开群晖 Docker ，在「注册表」标签卡中搜索「ehforwarderbot」，找到「jemyzhang/ehforwarderbot」下载映像，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic2@master/uPic/ehforwarderbot_reg.png" alt="ehforwarderbot_reg"></p>
<p>待下载完成，在「映像」标签卡中点击「启动」，选择「高级设置」，在「路径」选项卡中选择存放配置文件的路径，挂载路径填写 <code>/data</code>，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic2@master/uPic/ehforwarderbot_dir.png" alt="ehforwarderbot_dir"></p>
<p>之后启动容器，在「日志」或「终端机」中可以看到微信登录二维码，可以复制网址到浏览器，微信扫描二维码登录，登录成功日志会有显示，Telegram 可以收到微信的消息。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic2@master/uPic/ehforwarderbot_qr.png" alt="ehforwarderbot_qr"></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>Web 端支持的文字、语音、文件都可以转发至 Telegram，红包、定位、朋友圈等 Web 端没有的功能不支持。</p>
<h3 id="直接回复"><a href="#直接回复" class="headerlink" title="直接回复"></a>直接回复</h3><p>默认会将所有微信 Web 端的消息汇总至一个消息框中，想要回复可以直接发送命令<code>/chat</code>，选择要回复的联系人或群组，之后右滑返回的消息回复即可。另外还支持 <code>/chat 关键词</code> 快速定位要回复的联系人或群组。</p>
<h3 id="分组对话"><a href="#分组对话" class="headerlink" title="分组对话"></a>分组对话</h3><p>如果某个联系人或群组，可以首先用两个 Telegram 账号新建一个空白群组，之后向机器人发送命令 <code>/link</code> 将某个联系人或群组连接至空白群组，也支持 <code>/link 关键词</code> 快速链接联系人或群组，之后选择空白群组，链接好之后就可以实现消息分组。</p>
<h3 id="酷功能"><a href="#酷功能" class="headerlink" title="酷功能"></a>酷功能</h3><h4 id="超酷贴图"><a href="#超酷贴图" class="headerlink" title="超酷贴图"></a>超酷贴图</h4><p>Telegram 有很多不错的贴图，还有很多从 Line 移植过来的贴图，比微信的贴图精致很多，其中静态贴图可以直接发送至微信，动态贴图可以借助 <a href="https://t.me/Stickerdownloadbot" target="_blank" rel="noopener">Sticker download</a> 这个机器人将动态贴图转成 GIF 发送。</p>
<h4 id="定时发送"><a href="#定时发送" class="headerlink" title="定时发送"></a>定时发送</h4><p>Telegram 支持定时发送信息，这个也支持。</p>

                </article>
                <ul class="tags-postTags">
                    
                    <li>
                        <a href="/tags/Docker/" rel="tag"># Docker</a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </div>

    
    <nav id="gobottom" class="pagination">
        
        <a class="prev-post" title="谈谈电子书 DRM" href="/drm/">
            ← 谈谈电子书 DRM
        </a>
        
        <span class="prev-next-post">·</span>
        
        <a class="next-post" title="大国特色奇异技巧系列之一：群晖 Docker 接管百度网盘" href="/baidupan/">
            大国特色奇异技巧系列之一：群晖 Docker 接管百度网盘 →
        </a>
        
    </nav>

    
</div>






	</div>
	


	




<footer class="site-footer outer">
	<div class="site-footer-content inner">
		<div class="copyright">
			<a href="/" title="庄菲什">庄菲什 &copy; 2022</a>
			
				
    		
		</div>
		<nav class="site-footer-nav">
			
			<a href="https://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
			<a href="https://github.com/xzhih/hexo-theme-casper" title="Casper" target="_blank" rel="noopener">Casper</a>
		</nav>
	</div>
</footer>
	


<script>
    if(window.navigator && navigator.serviceWorker) {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
                registration.unregister()
            }
        })
    }
</script>


<script id="scriptLoad" src="/js/allinone.min.js" async></script>


<script>
    document.getElementById('scriptLoad').addEventListener('load', function () {
        
        

        
        

        
        
    })
</script>










</body>
</html>
