<!DOCTYPE html>
<html lang="zh-CN">







<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<link rel="preconnect" href="//www.googletagmanager.com">
	<link rel="preconnect" href="//zz.bdstatic.com">
	<link rel="preconnect" href="//sp0.baidu.com">
	<link rel="preconnect" href="//www.google-analytics.com">
	<link rel="preconnect" href="//cdn1.lncld.net">
	<link rel="preconnect" href="//unpkg.com">
	<link rel="preconnect" href="//app-router.leancloud.cn">
	<link rel="preconnect" href="//9qpuwspm.api.lncld.net">
	<link rel="preconnect" href="//gravatar.loli.net">

	<title>申请谷歌云及基本配置 | 庄菲什</title>

	<meta name="HandheldFriendly" content="True" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
	<meta name="generator" content="hexo">
	<meta name="author" content="drunkfish">
	<meta name="description" content="">

	

	

	

	

	

	<meta property="og:site_name" content="庄菲什">
	<meta property="og:type" content="article">
	<meta property="og:title" content="申请谷歌云及基本配置 | 庄菲什">
	<meta property="og:description" content="">
	<meta property="og:url" content="http://yoursite.com/gcp/">

	
	<meta property="article:published_time" content="2019-12-28T00:12:00+08:00"/> 
	<meta property="article:author" content="drunkfish">
	<meta property="article:published_first" content="庄菲什, /gcp/" />
	

	
	
	
<link rel="stylesheet" href="/css/allinonecss.min.css">


	
	
	
<link rel="alternate" href="/atom.xml" title="庄菲什" type="application/atom+xml">
</head>
<body class="post-template">
	<div class="site-wrapper">
		




<header class="site-header post-site-header outer">
    <div class="inner">
        
<nav class="site-nav"> 
    <div class="site-nav-left">
        <ul class="nav">
            <li>
                
                <a href="/" title="Home">HOME</a>
                
            </li>
            
        </ul> 
    </div>
     
    <div class="site-nav-right">
         
        
<div class="social-links" >
    
    
    
    
    
    
    
</div>
    </div>
</nav>
    </div>
</header>


<div id="site-main" class="site-main outer" role="main">
    <div class="inner">
        <header class="post-full-header">
            <div class="post-full-meta">
                <time  class="post-full-meta-date" datetime="2019-12-28T00:00:00.000Z">
                    2019-12-28
                </time>
                
                <span class="date-divider">/</span>
                
                
            </div>
            <h1 class="post-full-title">申请谷歌云及基本配置</h1>
        </header>
        <div class="post-full no-image">
            
            <div class="post-full-content">
                <article id="photoswipe" class="markdown-body">
                    <p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic2@master/uPic/gcp_cover.png" alt="gcp_cover"></p>
<p>Google Cloud Platform 是 Google 推出的云计算服务， Google 大方地提供 $300/年的试用，下面是申请步骤和基本配置：</p>
<h2 id="申请谷歌云"><a href="#申请谷歌云" class="headerlink" title="申请谷歌云"></a>申请谷歌云</h2><p>首先打开<a href="https://cloud.google.com/" target="_blank" rel="noopener">谷歌云</a>网站，之后登录 Google 账号，若无可以先注册一个。注册过程中可能需要提供手机号，有时候 +86 的手机号还可能验证不了，建议使用 <a href="https://www.google.com/intl/zh-TW/gmail/about/" target="_blank" rel="noopener">Gmail</a> App 在手机上注册 Google 账号，免输入手机号。</p>
<p>地区建议选择「美国」，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/apply_gcp1.png" alt="apply_gcp1"></p>
<p>之后需要填入一个美国地址，建议参考<a href="https://github.com/OneSecure/ShadowAgentNotes/blob/master/AppleID4USA.md" target="_blank" rel="noopener">这篇</a>填入一个「有效的」美国地址，在<a href="http://www.fakenamegenerator.com" target="_blank" rel="noopener">虚假个人信息生成器</a>网站选择选择 AK、DE、MT、NH，OR 五个免税州中的地址。</p>
<p>另外需要填入外币信用卡的信息（建议单标 Visa、MasterCard、American Express 卡，小弟的招商银行全币信用卡可用）（注意：这个付款信息还会作为 Google Pay 付款方式，之后如果在 Google Play 购买 App、影片、书籍等都可以通过这个付款信息。）。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/apply_gcp2.png" alt="apply_gcp2"></p>
<p>验证通过就可以领到 $300 赠金试用谷歌云了。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/gcp_index.png" alt="gcp_index"></p>
<h2 id="建立实例"><a href="#建立实例" class="headerlink" title="建立实例"></a>建立实例</h2><p>建立实例即启动一台服务器，在侧边栏「App Engine」中的「VM 执行个体」，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/new_vm1.png" alt="new_vm1"></p>
<p>之后可以选择服务器的配置、系统、地区等等（可根据偏好选择），记得勾选「允许 HTTP 流量」和「允许 HTPS 流量」，选好之后点击「建立」等待建立即可。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/new_vm2.png" alt="new_vm2"></p>
<p>若使用谷歌云搭建 V2ray等可以在建立实例前可以通过<a href="http://www.gcping.com/" target="_blank" rel="noopener">这个</a>或<a href="https://www.feitsui.com/zh-hans/cloud/gcp" target="_blank" rel="noopener">这个</a>网站初步测速选择国家。</p>
<h2 id="打开-SSH-权限"><a href="#打开-SSH-权限" class="headerlink" title="打开 SSH 权限"></a>打开 SSH 权限</h2><p>首先通过自带的 SSH 连接实例，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_ssh.png" alt="vm_ssh"></p>
<p>连接后获取 root 权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -i</span><br></pre></td></tr></table></figure>

<p>之后输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd</span><br></pre></td></tr></table></figure>

<p>此时可以输入新密码，之后再重复一次密码，注意输入的密码不会显示。</p>
<p>之后输入以下命令修改 SSH 配置文件，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br></pre></td></tr></table></figure>

<p>按<code>i</code>进入编辑模式，找到以下内容并修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PermitRootLogin yes           &#x2F;&#x2F;默认 no，改为yes</span><br><span class="line">PasswordAuthentication yes    &#x2F;&#x2F;默认 no，改为yes</span><br></pre></td></tr></table></figure>

<p>修改完成后，按 esc 键，之后输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:wq</span><br></pre></td></tr></table></figure>

<p>之后重启服务器，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure>

<p>此时服务器已经可以通过 SSH 连接了，打开系统终端机输入 <code>ssh root@服务器 IP</code> 即可连接。</p>
<p>另外还可以通过 SFTP 连接服务器进行文件传输，协议选择「SFTP」，地址填入服务器 IP 地址，用户名填写「root」。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/transmit.png" alt="transmit"></p>
<h2 id="打开防火墙"><a href="#打开防火墙" class="headerlink" title="打开防火墙"></a>打开防火墙</h2><p>服务器安装很多应用需要开启端口号才能正常使用，开启防火墙的步骤如下：</p>
<p>在「VPC 网路」中选择「防火墙规则」，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_firewall1.png" alt="vm_firewall1"></p>
<p>之后选择「建立防火墙规则」，为方面起见，可以设置允许所有入站请求，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_firewall2.png" alt="vm_firewall2"></p>
<p>名称任意，流量方向选择「输入」，来源IP范围填入「0.0.0.0/0」，之后建立即可。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_firewall3.png" alt="vm_firewall3"></p>
<h2 id="安装-Docker-及-Portainer"><a href="#安装-Docker-及-Portainer" class="headerlink" title="安装 Docker 及 Portainer"></a>安装 Docker 及 Portainer</h2><p><a href="https://www.docker.com" target="_blank" rel="noopener">Docker</a> 可以将操作系统虚拟，又比虚拟机占用更少的资源安装了，可以直接将很多安装步骤直接打包，节约很多时间，且独立于宿主机，不想用直接删除容器即可，非常方便。输入以下命令可以安装 Docker（另外谷歌云提供基于 Docker 的系统，可以直接选择，免安装）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https:&#x2F;&#x2F;get.docker.com -o get-docker.sh</span><br><span class="line">sudo sh get-docker.sh</span><br></pre></td></tr></table></figure>

<p><a href="https://www.portainer.io" target="_blank" rel="noopener">Portainer</a> 是一个 Docker 管理面板，可以首先可以创建 Portainer 卷，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume create portainer_data</span><br></pre></td></tr></table></figure>

<p>之后输入命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 9000:9000 --name portainer --restart always -v &#x2F;var&#x2F;run&#x2F;docker.sock:&#x2F;var&#x2F;run&#x2F;docker.sock -v portainer_data:&#x2F;data portainer&#x2F;portainer</span><br></pre></td></tr></table></figure>

<p>在浏览器访问服务器 IP:9000，即可进入 Portainer，上次进入需要设定密码，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/portain1.png" alt="uPic/portain1"></p>
<p>选择「local」，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/portain2.png" alt="uPic/portain2"></p>
<h2 id="设定静态-IP"><a href="#设定静态-IP" class="headerlink" title="设定静态 IP"></a>设定静态 IP</h2><p>服务器设定固定 IP 可以防止重启服务器后 IP 更换，在「VPC 网路」中选择「外部 IP 位址」，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/static_ip1.png" alt="static_ip1"></p>
<p>之后在「类型」中选择「静态」。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/static_ip2.png" alt="static_ip2"></p>
<h2 id="小提示"><a href="#小提示" class="headerlink" title="小提示"></a>小提示</h2><p>小弟建议不要点这个「启用」按钮，点了这个按钮之后待试用结束之后会直接扣费，不会有任何提示。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_tips.png" alt="vm_tips"></p>
<p>如果不慎点了这个按钮试用结束被扣费可以联系客服退款。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_mail.png" alt="vm_mail"></p>
<h2 id="修改-VM-配置"><a href="#修改-VM-配置" class="headerlink" title="修改 VM 配置"></a>修改 VM 配置</h2><p>如果使用过程中配置不够，可以调整配置。首先可以将实例关机，注意若未使用静态 IP，重启后 IP 会改变，点击实例名称，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_modify1.png" alt="vm_modify1"></p>
<p>若要修改内存、CPU 可以点击[编辑]按钮修改，若要修改磁盘容量可以找到「开机磁盘」，点击实例名称进行修改。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_modify2.png" alt="vm_modify2"></p>
<h2 id="到期续用"><a href="#到期续用" class="headerlink" title="到期续用"></a>到期续用</h2><p>谷歌云一个账号免费试用时间是一年，到期后实例会保留，但是开机会开始计费。如果想继续免费试用，可以通过共享付费账户的方法继续试用，操作如下：</p>
<p>首先新注册一个 Google 账号，填写信息，申请谷歌云免费试用，在「账单」中选择「账户管理」，点击「显示资讯面板」，之后选择「新增成员」（在新增之前可以先更改账单账户名称，方便以后选择），</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_change0.png" alt="vm_change0"></p>
<p>填入「旧的」Google 账号，角色选择「账单账户管理员」，点击「储存」，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_change1.png" alt="vm_change1"></p>
<p>登录「旧的」Google 账号，选择「账单」，选择「连结至账单账户」，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_change2.png" alt="vm_change2"></p>
<p>选择「变更计费功能」，之后选择「新的」Google 账户的「账单账户」，这样「旧的」Google 账号就可以使用「旧的」Google 账号的账单了。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/vm_change3.png" alt="vm_change3"></p>
<h2 id="风险"><a href="#风险" class="headerlink" title="风险"></a>风险</h2><p>谷歌云免费试用政策可能改变，或者我们可能会忘记一年使用截止日期，建议及时将重要数据备份。</p>

                </article>
                <ul class="tags-postTags">
                    
                    <li>
                        <a href="/tags/docker/" rel="tag"># docker</a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </div>

    
    <nav id="gobottom" class="pagination">
        
        <a class="prev-post" title="Freenom 申请免费域名" href="/domain/">
            ← Freenom 申请免费域名
        </a>
        
        <span class="prev-next-post">·</span>
        
        <a class="next-post" title="程序员健康优化小工具——古老的东方放松术" href="/yoga/">
            程序员健康优化小工具——古老的东方放松术 →
        </a>
        
    </nav>

    
</div>






	</div>
	


	




<footer class="site-footer outer">
	<div class="site-footer-content inner">
		<div class="copyright">
			<a href="/" title="庄菲什">庄菲什 &copy; 2022</a>
			
				
    		
		</div>
		<nav class="site-footer-nav">
			
			<a href="https://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
			<a href="https://github.com/xzhih/hexo-theme-casper" title="Casper" target="_blank" rel="noopener">Casper</a>
		</nav>
	</div>
</footer>
	


<script>
    if(window.navigator && navigator.serviceWorker) {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
                registration.unregister()
            }
        })
    }
</script>


<script id="scriptLoad" src="/js/allinone.min.js" async></script>


<script>
    document.getElementById('scriptLoad').addEventListener('load', function () {
        
        

        
        

        
        
    })
</script>










</body>
</html>
