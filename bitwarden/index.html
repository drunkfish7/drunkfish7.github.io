<!DOCTYPE html>
<html lang="zh-CN">







<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<link rel="preconnect" href="//www.googletagmanager.com">
	<link rel="preconnect" href="//zz.bdstatic.com">
	<link rel="preconnect" href="//sp0.baidu.com">
	<link rel="preconnect" href="//www.google-analytics.com">
	<link rel="preconnect" href="//cdn1.lncld.net">
	<link rel="preconnect" href="//unpkg.com">
	<link rel="preconnect" href="//app-router.leancloud.cn">
	<link rel="preconnect" href="//9qpuwspm.api.lncld.net">
	<link rel="preconnect" href="//gravatar.loli.net">

	<title>使用 Bitwarden 搭建密码管理 | 庄菲什</title>

	<meta name="HandheldFriendly" content="True" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
	<meta name="generator" content="hexo">
	<meta name="author" content="drunkfish">
	<meta name="description" content="">

	

	

	

	

	

	<meta property="og:site_name" content="庄菲什">
	<meta property="og:type" content="article">
	<meta property="og:title" content="使用 Bitwarden 搭建密码管理 | 庄菲什">
	<meta property="og:description" content="">
	<meta property="og:url" content="http://yoursite.com/bitwarden/">

	
	<meta property="article:published_time" content="2020-12-14T00:12:00+08:00"/> 
	<meta property="article:author" content="drunkfish">
	<meta property="article:published_first" content="庄菲什, /bitwarden/" />
	

	
	
	
<link rel="stylesheet" href="/css/allinonecss.min.css">


	
	
	
<link rel="alternate" href="/atom.xml" title="庄菲什" type="application/atom+xml">
</head>
<body class="post-template">
	<div class="site-wrapper">
		




<header class="site-header post-site-header outer">
    <div class="inner">
        
<nav class="site-nav"> 
    <div class="site-nav-left">
        <ul class="nav">
            <li>
                
                <a href="/" title="Home">HOME</a>
                
            </li>
            
        </ul> 
    </div>
     
    <div class="site-nav-right">
         
        
<div class="social-links" >
    
    
    
    
    
    
    
</div>
    </div>
</nav>
    </div>
</header>


<div id="site-main" class="site-main outer" role="main">
    <div class="inner">
        <header class="post-full-header">
            <div class="post-full-meta">
                <time  class="post-full-meta-date" datetime="2020-12-14T00:00:00.000Z">
                    2020-12-14
                </time>
                
                <span class="date-divider">/</span>
                
                
            </div>
            <h1 class="post-full-title">使用 Bitwarden 搭建密码管理</h1>
        </header>
        <div class="post-full no-image">
            
            <div class="post-full-content">
                <article id="photoswipe" class="markdown-body">
                    <p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/bitwarden_cover.png" alt="bitwarden_cover"></p>
<p>使用密码管理工具管理密码理由很多，最主要的是方便、安全。Bitwarden 是一个开源的密码管理服务，全平台支持，介面简洁，前后端均开源（Telegram 仅客户端开源）功能全面，支持两步验证（Lastpass 付费版都不支持的功能）、团队共享密码库，另外，支持将服务端部署在自己的服务器上。</p>
<p>小弟尝试在群晖搭建 Bitwarden 服务端，期间踩了一些坑，主要参考了<a href="https://www.chiphell.com/thread-2006498-1-1.html" target="_blank" rel="noopener">这位大大的帖子</a>。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>首先需要配置好域名和 SSL 证书，最简单的是利用群晖自带功能申请一个二级域名，并为这个二级域名申请 SSL 证书。在群晖「控制面板」→「安全」中导出证书，导出得到一个压缩包备用，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/bitwarden_export_ssl.png" alt="bitwarden_export_ssl"></p>
<p>新建一个文件夹存放密码数据库，一个文件夹存放 SSL 证书，并将导出的证书压缩包解压至这个文件夹。</p>
<h2 id="Docker-安装"><a href="#Docker-安装" class="headerlink" title="Docker 安装"></a>Docker 安装</h2><p>打开群晖 Docker，在「注册表」 中搜索 <code>bitwardenr</code>，找到 <code>bitwardenrs/server</code> 并选择 latest 下载。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/bitwarden_docker1.png" alt="bitwarden_docker1"></p>
<p>待镜像下载完成（有群晖系统通知），到「映像」中找到并双击打开下载好的镜像，点击「高级设置」，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/bitwarden_docker2.png" alt="bitwarden_docker2"></p>
<p>在「卷」 中添加路径存放密码数据库的文件夹，装载路径为<code>/data</code>，添加存放 SSL 证书的文件夹，装载路径为 <code>/ssl</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/bitwarden_docker3.png" alt="bitwarden_docker3"></p>
<p>在 「端口设置」中自定义容器端口 <code>80</code> 所对应的本地端口，删去自带的 <code>3021</code> 的容器端口，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/bitwarden_docker4.png" alt="bitwarden_docker4"></p>
<p>在环境变量中添加 <code>ROCKET_TLS</code>，值为 <code>{certs=&quot;/ssl/cert.pem&quot;,key=&quot;/ssl/privkey.pem&quot;}</code>（值里面的文件名改为自己的证书的文件名），点击应用保存。</p>
<h2 id="设置端口映射"><a href="#设置端口映射" class="headerlink" title="设置端口映射"></a>设置端口映射</h2><p>在路由器中设置好端口转发（确保有有公网 IP），OpenWrt 系统可以在「网络」→「防火墙」→「端口转发」中找到。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic@master/uPic/openwrt23_new.png" alt="bitwarden_port"></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>在浏览器中输入 <code>https:// &lt;DDNS 域名&gt;:&lt;端口号&gt;</code> 即可访问刚刚搭建的 Bitwarden 服务，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/bitwarden_web.png" alt="bitwarden_web"></p>
<p>之后注册一个账号即可使用，注意千万牢记主密码。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/bitwarden_web2.png" alt="bitwarden_web2"></p>
<p>各端客户端可以到官方下载专区 <a href="https://bitwarden.com/download/" target="_blank" rel="noopener">https://bitwarden.com/download/</a> 下载，使用方法大致相同，在设置中填写服务器地址即可。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/bitwarden_url.png" alt="bitwarden_url"></p>
<h2 id="维护"><a href="#维护" class="headerlink" title="维护"></a>维护</h2><p>如果用的是群晖申请的 Let’s Encrypt 证书，3 个月证书会过期，过期之后重新导出证书文件覆盖即可。</p>

                </article>
                <ul class="tags-postTags">
                    
                    <li>
                        <a href="/tags/Docker/" rel="tag"># Docker</a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </div>

    
    <nav id="gobottom" class="pagination">
        
        <a class="prev-post" title="电子版单向历使用" href="/oneway/">
            ← 电子版单向历使用
        </a>
        
        <span class="prev-next-post">·</span>
        
        <a class="next-post" title="租房小物推荐（二）" href="/necessary2/">
            租房小物推荐（二） →
        </a>
        
    </nav>

    
</div>






	</div>
	


	




<footer class="site-footer outer">
	<div class="site-footer-content inner">
		<div class="copyright">
			<a href="/" title="庄菲什">庄菲什 &copy; 2022</a>
			
				
    		
		</div>
		<nav class="site-footer-nav">
			
			<a href="https://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
			<a href="https://github.com/xzhih/hexo-theme-casper" title="Casper" target="_blank" rel="noopener">Casper</a>
		</nav>
	</div>
</footer>
	


<script>
    if(window.navigator && navigator.serviceWorker) {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
                registration.unregister()
            }
        })
    }
</script>


<script id="scriptLoad" src="/js/allinone.min.js" async></script>


<script>
    document.getElementById('scriptLoad').addEventListener('load', function () {
        
        

        
        

        
        
    })
</script>










</body>
</html>
