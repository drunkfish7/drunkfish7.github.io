<!DOCTYPE html>
<html lang="zh-CN">







<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<link rel="preconnect" href="//www.googletagmanager.com">
	<link rel="preconnect" href="//zz.bdstatic.com">
	<link rel="preconnect" href="//sp0.baidu.com">
	<link rel="preconnect" href="//www.google-analytics.com">
	<link rel="preconnect" href="//cdn1.lncld.net">
	<link rel="preconnect" href="//unpkg.com">
	<link rel="preconnect" href="//app-router.leancloud.cn">
	<link rel="preconnect" href="//9qpuwspm.api.lncld.net">
	<link rel="preconnect" href="//gravatar.loli.net">

	<title>使用 Adguard Home 过滤国内广告 | 庄菲什</title>

	<meta name="HandheldFriendly" content="True" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
	<meta name="generator" content="hexo">
	<meta name="author" content="drunkfish">
	<meta name="description" content="">

	

	

	

	

	

	<meta property="og:site_name" content="庄菲什">
	<meta property="og:type" content="article">
	<meta property="og:title" content="使用 Adguard Home 过滤国内广告 | 庄菲什">
	<meta property="og:description" content="">
	<meta property="og:url" content="http://yoursite.com/dns/">

	
	<meta property="article:published_time" content="2021-02-28T00:02:00+08:00"/> 
	<meta property="article:author" content="drunkfish">
	<meta property="article:published_first" content="庄菲什, /dns/" />
	

	
	
	
<link rel="stylesheet" href="/css/allinonecss.min.css">


	
	
	
<link rel="alternate" href="/atom.xml" title="庄菲什" type="application/atom+xml">
</head>
<body class="post-template">
	<div class="site-wrapper">
		




<header class="site-header post-site-header outer">
    <div class="inner">
        
<nav class="site-nav"> 
    <div class="site-nav-left">
        <ul class="nav">
            <li>
                
                <a href="/" title="Home">HOME</a>
                
            </li>
            
        </ul> 
    </div>
     
    <div class="site-nav-right">
         
        
<div class="social-links" >
    
    
    
    
    
    
    
</div>
    </div>
</nav>
    </div>
</header>


<div id="site-main" class="site-main outer" role="main">
    <div class="inner">
        <header class="post-full-header">
            <div class="post-full-meta">
                <time  class="post-full-meta-date" datetime="2021-02-28T00:00:00.000Z">
                    2021-02-28
                </time>
                
                <span class="date-divider">/</span>
                
                
            </div>
            <h1 class="post-full-title">使用 Adguard Home 过滤国内广告</h1>
        </header>
        <div class="post-full no-image">
            
            <div class="post-full-content">
                <article id="photoswipe" class="markdown-body">
                    <p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/dns_cover.png" alt="dns_cover"></p>
<p>新世纪，我们的生活似乎充满了广告。一方面，适当、相对精准的广告推送可以连接供给与需求，有些需付费的媒体内容因为广告可以免费看。另一方面，频繁、打断式的广告令人生厌，掌握用户行为数据的广告商还利用我们的弱点诱导购买很多不必要的东西。</p>
<p>在天下第一经济大国先进熊猫国，没有外来害虫侵入的沃土，国民享有更多干扰性强、不体面的广告，各类侵入性强的广告数量与比例比低端国家领先一大截，是驰名海外的中国之光。</p>
<p><a href="https://adguard.com/en/adguard-home/overview.html" target="_blank" rel="noopener">Adguard Home</a> 是一个开源的 DNS 服务，可以通过拦截 DNS 的方式阻挡广告及追踪，并且可以方便地安装在各类设备中。这篇文章主要是 Adguard Home 在 OpenWrt 下的使用。</p>
<h2 id="设定"><a href="#设定" class="headerlink" title="设定"></a>设定</h2><p>大多数 OpenWrt 固件有内置 Adguard Home 插件，进入 OpenWrt 管理界面，打开「服务」→「Adguard Home」，重定向选中「dnsmasq 的上游服务器」，勾选启用并「保存并启用」。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/dns_1.png" alt="dns1"></p>
<p>如果使用 Hello World 这类科学上网类插件，可以设置DNS解析方式为「使用 PDNSD TCP 查询并缓存」。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/dns_2.png" alt="dns2"></p>
<p>建议关闭 Turbo ACC 网络加速设置中的「DNS 缓存」。</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/dns_3.png" alt="dns3"></p>
<p>设定好之后打开地址 <code>AdGuard Home 地址:端口号</code>可以进一步设置 AdGuard Home，在「设置」→「DNS 设置」中可以添加上游 DNS 服务器与 Bootstrap DNS 服务器（有些固件已经添加好了），另外建议无需添加过多，过多添加可能会消耗更多系统资源，且有点让自己访问的域名「让全天下的人都知道」的感觉，</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/dns_4.png" alt="dns4"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">上游 DNS 服务器</span><br><span class="line">tls:&#x2F;&#x2F;1dot1dot1dot1.cloudflare-dns.com</span><br><span class="line">tls:&#x2F;&#x2F;dns.google</span><br><span class="line">tcp:&#x2F;&#x2F;8.8.4.4</span><br><span class="line">223.5.5.5</span><br><span class="line">223.6.6.6</span><br><span class="line">119.29.29.29</span><br><span class="line">114.114.114.114</span><br><span class="line"></span><br><span class="line">Bootstrap DNS 服务器</span><br><span class="line">119.29.29.29</span><br><span class="line">223.5.5.5</span><br><span class="line">114.114.114.114</span><br><span class="line">2620:fe::10</span><br><span class="line">2620:fe::fe:10</span><br></pre></td></tr></table></figure>

<p>去广告效果和拦截清单有关，一个精准且更新及时的清单可以达到更好的效果，在「过滤器」→「DNS 封锁清单」中可以添加过滤清单（有些固件已经添加好了），以下是几个比较好用的列表：</p>
<p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/dns_5.png" alt="dns5"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">NEO DEV HOST</span><br><span class="line">https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;neodevpro&#x2F;neodevhost&#x2F;master&#x2F;adblocker</span><br><span class="line"></span><br><span class="line">adgk 手机去广告规则</span><br><span class="line">https:&#x2F;&#x2F;banbendalao.coding.net&#x2F;p&#x2F;adgk&#x2F;d&#x2F;ADgk&#x2F;git&#x2F;raw&#x2F;master&#x2F;ADgk.txt</span><br><span class="line"></span><br><span class="line">anti-AD 命中率最高列表</span><br><span class="line">https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;privacy-protection-tools&#x2F;anti-AD@master&#x2F;anti-ad-easylist.txt</span><br></pre></td></tr></table></figure>

<p>另外，Adguard Home 的配置都存在一个 yaml 文件，也可以通过修改 yaml 文件修改配置。    </p>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src="https://cdn.jsdelivr.net/gh/drunkfish7/pic3@master/uPic/dns_6.png" alt="dns6"></p>
<p>配置好之后可以在 Adguard Home 仪表盘看到 DNS 查询数与拦截数，查询日志中也可以看到域名查询日志。局域网中的终端无需配置即可使用，被拦截的广告会显示空白。</p>
<p>Adguard Home 是利用 DNS 去广告，这种方式去广告方式效果有限，Adguard Home 曾<a href="https://adguard.com/en/blog/adguard-vs-adaway-dns66.html" target="_blank" rel="noopener">撰文</a>比较 DNS 过滤与其他广告拦截工具对比，若广告域名与主要内容是同一个域名，这种方式就无能为力了。但是总体来说，还是去广告有效果的，对防止追踪也有一定效果。</p>
<p>另外，这种方式对外网去广告无效，科学上网是 VPS 请求域名解析，不会将域名到本地解析。</p>

                </article>
                <ul class="tags-postTags">
                    
                </ul>
            </div>
        </div>
    </div>

    
    <nav id="gobottom" class="pagination">
        
        <a class="prev-post" title="善用悲观的力量——Using Ancient Philosophy to Live a Modern Life" href="/stoic/">
            ← 善用悲观的力量——Using Ancient Philosophy to Live a Modern Life
        </a>
        
        <span class="prev-next-post">·</span>
        
        <a class="next-post" title="免下载！在线媒体资源推荐" href="/media/">
            免下载！在线媒体资源推荐 →
        </a>
        
    </nav>

    
</div>






	</div>
	


	




<footer class="site-footer outer">
	<div class="site-footer-content inner">
		<div class="copyright">
			<a href="/" title="庄菲什">庄菲什 &copy; 2022</a>
			
				
    		
		</div>
		<nav class="site-footer-nav">
			
			<a href="https://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
			<a href="https://github.com/xzhih/hexo-theme-casper" title="Casper" target="_blank" rel="noopener">Casper</a>
		</nav>
	</div>
</footer>
	


<script>
    if(window.navigator && navigator.serviceWorker) {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
                registration.unregister()
            }
        })
    }
</script>


<script id="scriptLoad" src="/js/allinone.min.js" async></script>


<script>
    document.getElementById('scriptLoad').addEventListener('load', function () {
        
        

        
        

        
        
    })
</script>










</body>
</html>
